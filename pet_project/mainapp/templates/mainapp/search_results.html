{% extends 'mainapp/base.html' %}
{% load widget_tweaks %}
{% block content %}


    <div class="container">
        <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞</h2>

        <form method="GET" action="{% url 'search' %}">
            {% render_field form.query  class="form-control" placeholder="–ß—Ç–æ –∏—â–µ—Ç–µ?" type="text"  %}
            <button class='reg_btn' type="submit">–ü–æ–∏—Å–∫</button>
        </form>

        {% if query %}
            <h3>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:</h3>
            {% for user in results_users %}
                <div class="post">{{ user.username }}</div>
            {% empty %}
                <p>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.</p>
            {% endfor %}
            <h3>–ü–æ—Å—Ç—ã:</h3>
            {% for post in results_posts %}
                <div class="post">
                    <div class="author">
                        <img src="{{ post.author.profile_picture.url }}" class="avatar">
                        <p class="post-author"><a
                                href="{% url 'profile' post.author.username %}">{{ post.author.username }}</a>
                            @{{ post.author }}</p>
                    </div>
                    <div class="content">
                        <p>{{ post.content }}</p>
                        <div class="actions">
                            <button class="like-button" data-post-id="{{ post.id }}">
                                {% if not user.is_authenticated %}
                                    <a href="{% url 'login' %}">ü§ç{{ post.likes.count }}</a>
                                {% else %}
                                    {% if user in post.likes.all %}
                                        ‚ù§Ô∏è <span id="like-count-{{ post.id }}">{{ post.likes.count }}</span>
                                    {% else %}
                                        ü§ç <span id="like-count-{{ post.id }}">{{ post.likes.count }}</span>
                                    {% endif %}
                                {% endif %}
                            </button>
                            <a href="comment/{{ post.id }}">üí¨</a>
                        </div>
                    </div>
                </div>
            {% empty %}
                <p>–ü–æ—Å—Ç–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.</p>
            {% endfor %}
        {% endif %}
    </div>
{% endblock %}
